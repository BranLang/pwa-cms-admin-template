<div class="app-layout">
  <md-top-app-bar>
    <div [routerLink]="['/']" class="brand">{{ localizedTitle() }}</div>
    <div style="flex: 1"></div>

    <!-- Desktop Navigation -->
    <nav class="navigation-desktop">
      @if (menuItems() && menuItems().length > 0) {
        @for (m of menuItems(); track m.id) {
          @if (!m.children?.length) {
            <md-text-button [routerLink]="[m.path]" routerLinkActive="active-link">{{ m.i18nKey | translate }}</md-text-button>
          } @else {
            <div class="menu-container">
              <md-text-button (click)="toggleMenu(m.id)">
                {{ m.i18nKey | translate }}
                <md-icon>expand_more</md-icon>
              </md-text-button>
              <md-menu [attr.id]="'menu-' + m.id" (closed)="closeMenu(m.id)">
                @for (c of m.children; track c.id) {
                  <md-menu-item [routerLink]="[c.path]">
                    <div slot="headline">{{ c.i18nKey | translate }}</div>
                  </md-menu-item>
                }
              </md-menu>
            </div>
          }
        }
      }
    </nav>

    <div style="flex: 1"></div>

    <div class="actions">
      <!-- Theme selector -->
      <md-icon-button (click)="toggleMenu('theme-menu')" class="theme-toggle" aria-label="Change theme">
        <md-icon>format_color_fill</md-icon>
      </md-icon-button>
      <md-menu id="theme-menu" (closed)="closeMenu('theme-menu')">
        @for (opt of availableThemes(); track trackById($index, opt)) {
          <md-menu-item (click)="setTheme(opt.id)" [class.selected]="theme() === opt.id">
            <div slot="headline">{{ opt.name }}</div>
          </md-menu-item>
        }
      </md-menu>

      <!-- Language selector -->
      <md-icon-button (click)="toggleMenu('lang-menu')" class="lang-toggle" [attr.aria-label]="'nav.language' | translate">
        <md-icon>language</md-icon>
      </md-icon-button>
      <md-menu id="lang-menu" (closed)="closeMenu('lang-menu')">
        <md-menu-item (click)="switchLanguage('sk')">
          <div slot="headline">SK</div>
        </md-menu-item>
        <md-menu-item (click)="switchLanguage('en')">
          <div slot="headline">EN</div>
        </md-menu-item>
      </md-menu>
    </div>

    <!-- Mobile Navigation -->
    <md-icon-button (click)="toggleDrawer()" class="navigation-mobile-menu-button">
      <md-icon>menu</md-icon>
    </md-icon-button>
  </md-top-app-bar>

  <md-navigation-drawer #drawer>
    <div class="navigation-mobile">
      @if (menuItems() && menuItems().length > 0) {
        @for (m of menuItems(); track m.id) {
          @if (!m.children?.length) {
            <md-text-button [routerLink]="[m.path]" routerLinkActive="active-link">{{ m.i18nKey | translate }}</md-text-button>
          } @else {
            <div class="menu-container">
              <md-text-button (click)="toggleMenu('mobile-menu-' + m.id)">
                {{ m.i18nKey | translate }}
                <md-icon>expand_more</md-icon>
              </md-text-button>
              <md-menu [attr.id]="'mobile-menu-' + m.id" (closed)="closeMenu('mobile-menu-' + m.id)">
                @for (c of m.children; track c.id) {
                  <md-menu-item [routerLink]="[c.path]">
                    <div slot="headline">{{ c.i18nKey | translate }}</div>
                  </md-menu-item>
                }
              </md-menu>
            </div>
          }
        }
      }
    </div>
  </md-navigation-drawer>

  <main class="layout-content">
    <router-outlet />
  </main>

  <app-footer></app-footer>
</div>
