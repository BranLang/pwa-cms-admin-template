<mat-toolbar color="primary" class="toolbar">
  <div class="brand" [routerLink]="['/']">{{ localizedTitle() }}</div>

  <span class="spacer"></span>



  <nav class="nav">
    @if (menuItems() && menuItems().length > 0) {
      @for (m of menuItems(); track m.id) {
        @if (!m.children?.length) {
          <a mat-button [routerLink]="[m.path]" routerLinkActive="active-link">{{ m.i18nKey | translate }}</a>
        } @else {
          <button mat-button [matMenuTriggerFor]="parentMenu" class="menu-trigger">
            {{ m.i18nKey | translate }}
            <mat-icon>expand_more</mat-icon>
          </button>
          <mat-menu #parentMenu="matMenu" class="submenu">
            @for (c of m.children; track c.id) {
              @if (!c.children?.length) {
                <a mat-menu-item [routerLink]="[c.path]">
                  <mat-icon>chevron_right</mat-icon>
                  <span>{{ c.i18nKey | translate }}</span>
                </a>
              } @else {
                <button mat-menu-item [matMenuTriggerFor]="childMenu">
                  <mat-icon>chevron_right</mat-icon>
                  <span>{{ c.i18nKey | translate }}</span>
                </button>
                <mat-menu #childMenu="matMenu" class="submenu">
                  @for (gc of c.children; track gc.id) {
                    <a mat-menu-item [routerLink]="[gc.path]">
                      <mat-icon>chevron_right</mat-icon>
                      <span>{{ gc.i18nKey | translate }}</span>
                    </a>
                  }
                </mat-menu>
              }
            }
          </mat-menu>
        }
      }
    } @else {
      <span style="color: white; font-size: 12px;">No menu items loaded</span>
    }
  </nav>

  <span class="spacer"></span>

  <div class="actions">
    <!-- Theme selector -->
    <button mat-icon-button
            [matMenuTriggerFor]="themeMenu"
            class="theme-toggle"
            aria-label="Change theme">
      <mat-icon>format_color_fill</mat-icon>
    </button>

    <!-- Theme menu -->
    <mat-menu #themeMenu="matMenu" [overlapTrigger]="false" class="theme-menu">
      @for (opt of availableThemes(); track trackById($index, opt)) {
        <button mat-menu-item (click)="setTheme(opt.id)" [class.selected]="theme() === opt.id">
          <div class="theme-option">
            <div class="theme-swatch" [style.background]="'linear-gradient(135deg, ' + opt.primaryColor + ' 0%, ' + opt.primaryColor + ' 50%, ' + opt.accentColor + ' 50%, ' + opt.accentColor + ' 100%)'">
              @if (theme() === opt.id) {
                <mat-icon class="selected-icon">check_circle</mat-icon>
              }
            </div>
            <div class="theme-info">
              <span class="theme-name">{{ opt.name }}</span>
              <span class="theme-description">{{ opt.description }}</span>
            </div>
          </div>
        </button>
      }
    </mat-menu>

    <!-- Language selector -->
    <button mat-icon-button [matMenuTriggerFor]="langMenu" class="lang-toggle" [attr.aria-label]="'nav.language' | translate">
      <mat-icon>language</mat-icon>
    </button>
    <mat-menu #langMenu="matMenu" class="lang-menu">
      <button mat-menu-item (click)="switchLanguage('sk')" class="lang-option">
        <span class="lang-code">SK</span>
        <span class="lang-name">{{ 'lang.sk' | translate }}</span>
      </button>
      <button mat-menu-item (click)="switchLanguage('en')" class="lang-option">
        <span class="lang-code">EN</span>
        <span class="lang-name">{{ 'lang.en' | translate }}</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>

<main class="layout-content">
  <router-outlet />
</main>


